2024-09-12 00:00:42,045 - DEBUG - matplotlib - wrapper() - matplotlib data path: c:\Users\chogarth\AppData\Local\Programs\Python\Python310\lib\site-packages\matplotlib\mpl-data
2024-09-12 00:00:42,051 - DEBUG - matplotlib - wrapper() - CONFIGDIR=C:\Users\chogarth\.matplotlib
2024-09-12 00:00:42,051 - DEBUG - matplotlib - <module>() - interactive is False
2024-09-12 00:00:42,051 - DEBUG - matplotlib - <module>() - platform is win32
2024-09-12 00:00:42,075 - DEBUG - matplotlib - wrapper() - CACHEDIR=C:\Users\chogarth\.matplotlib
2024-09-12 00:00:42,079 - DEBUG - matplotlib.font_manager - _load_fontmanager() - Using fontManager instance from C:\Users\chogarth\.matplotlib\fontlist-v330.json
2024-09-12 00:00:42,593 - DEBUG - asyncio - __init__() - Using selector: SelectSelector
2024-09-12 00:00:58,640 - INFO - samplicity.scr.scr - f_calculate() - Completed Diversification calculations
2024-09-12 00:00:58,759 - INFO - samplicity.scr.scr - f_calculate() - Completed Premium and Reserve Risk
2024-09-12 00:00:58,914 - INFO - samplicity.scr.scr - f_calculate() - Completed Natural Catastrophe Risk
2024-09-12 00:00:59,023 - INFO - samplicity.scr.scr - f_calculate() - Completed Factor Catastrophe Risk
2024-09-12 00:00:59,222 - INFO - samplicity.scr.scr - f_calculate() - Completed Man-Made Catastrophe Risk
2024-09-12 00:00:59,229 - INFO - samplicity.scr.scr - f_calculate() - Completed Non-Proportional Reinsurance Risk
2024-09-12 00:00:59,425 - CRITICAL - samplicity.non_prop - f_data() - Error: reinsurance - np_property
2024-09-12 00:00:59,425 - CRITICAL - samplicity.non_prop - f_data() - Error: reinsurance - np_credit_guarantee
2024-09-12 00:00:59,775 - INFO - samplicity.scr.scr - f_calculate() - Completed Reinsurance Risk
2024-09-12 00:00:59,784 - INFO - samplicity.scr.scr - f_calculate() - Completed Operational Risk
2024-09-12 00:00:59,903 - ERROR - samplicity.scr.scr - handle_calculation_error() - Error in Market Risk: "['counterparty_id'] not found in axis"
2024-09-12 00:00:59,903 - DEBUG - samplicity.scr.scr - handle_calculation_error() - Error details: {'type': 'error', 'step': 'Market Risk', 'error_type': 'KeyError', 'error_message': '"[\'counterparty_id\'] not found in axis"', 'traceback': 'Traceback (most recent call last):\n  File "c:\\git_hub/samplicity\\samplicity\\scr\\scr.py", line 242, in f_calculate\n    step_func()\n  File "c:\\git_hub/samplicity\\samplicity\\scr\\scr.py", line 187, in create_market_risk\n    return Market(self, "market_risk", True)\n  File "c:\\git_hub/samplicity\\samplicity\\helper.py", line 403, in wrapper\n    result = func(*args, **kwargs)\n  File "c:\\git_hub/samplicity\\samplicity\\market\\market.py", line 261, in __init__\n    self.f_calc_impairment()\n  File "c:\\git_hub/samplicity\\samplicity\\helper.py", line 403, in wrapper\n    result = func(*args, **kwargs)\n  File "c:\\git_hub/samplicity\\samplicity\\market\\market.py", line 495, in f_calc_impairment\n    self.output["impairment_charge"] = f_impairment(self)\n  File "c:\\git_hub/samplicity\\samplicity\\market\\credit.py", line 61, in f_impairment\n    f_get_total_row(data)\n  File "c:\\Users\\chogarth\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pandas\\core\\frame.py", line 5344, in drop\n    return super().drop(\n  File "c:\\Users\\chogarth\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pandas\\core\\generic.py", line 4711, in drop\n    obj = obj._drop_axis(labels, axis, level=level, errors=errors)\n  File "c:\\Users\\chogarth\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pandas\\core\\generic.py", line 4753, in _drop_axis\n    new_axis = axis.drop(labels, errors=errors)\n  File "c:\\Users\\chogarth\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\pandas\\core\\indexes\\base.py", line 6992, in drop\n    raise KeyError(f"{labels[mask].tolist()} not found in axis")\nKeyError: "[\'counterparty_id\'] not found in axis"\n'}
2024-09-12 00:00:59,903 - WARNING - samplicity.scr.scr - handle_calculation_error() - Non-critical error in Market Risk. Continuing with next step.
2024-09-12 00:00:59,904 - INFO - samplicity.scr.scr - f_calculate() - Completed Market Risk
2024-09-12 00:01:00,597 - CRITICAL - samplicity.non_prop - f_data() - Error: base - np_all
2024-09-12 00:01:00,597 - CRITICAL - samplicity.market.market - f_data() - Error: impairment_charge - all
2024-09-12 00:01:00,597 - CRITICAL - samplicity.scr.scr - f_data() - f_data: market_risk - impairment_charge - all
2024-09-12 00:01:00,598 - ERROR - samplicity.scr.scr - handle_calculation_error() - Error in Aggregation: cannot find market_risk - impairment_charge - all
2024-09-12 00:01:00,598 - DEBUG - samplicity.scr.scr - handle_calculation_error() - Error details: {'type': 'error', 'step': 'Aggregation', 'error_type': 'ValueError', 'error_message': 'cannot find market_risk - impairment_charge - all', 'traceback': 'Traceback (most recent call last):\n  File "c:\\git_hub/samplicity\\samplicity\\market\\market.py", line 517, in f_data\n    df = self.__f_impair_data()\n  File "c:\\git_hub/samplicity\\samplicity\\market\\market.py", line 537, in __f_impair_data\n    for k, df in self.output["impairment_charge"].items()\nKeyError: \'impairment_charge\'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "c:\\git_hub/samplicity\\samplicity\\scr\\scr.py", line 501, in f_data\n    df = self.classes[module].f_data(data, sub_data)\n  File "c:\\git_hub/samplicity\\samplicity\\market\\market.py", line 523, in f_data\n    raise ValueError\nValueError\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "c:\\git_hub/samplicity\\samplicity\\scr\\scr.py", line 242, in f_calculate\n    step_func()\n  File "c:\\git_hub/samplicity\\samplicity\\helper.py", line 403, in wrapper\n    result = func(*args, **kwargs)\n  File "c:\\git_hub/samplicity\\samplicity\\scr\\scr.py", line 289, in f_aggregation\n    res = agg.f_agg_scr(self)\n  File "c:\\git_hub/samplicity\\samplicity\\helper.py", line 403, in wrapper\n    result = func(*args, **kwargs)\n  File "c:\\git_hub/samplicity\\samplicity\\scr\\aggregation.py", line 219, in f_agg_scr\n    right_df = sam_scr.f_data("market_risk", "impairment_charge", "all")\n  File "c:\\git_hub/samplicity\\samplicity\\scr\\scr.py", line 504, in f_data\n    raise ValueError(f"cannot find {module} - {data} - {sub_data}")\nValueError: cannot find market_risk - impairment_charge - all\n'}
2024-09-12 00:01:00,598 - WARNING - samplicity.scr.scr - handle_calculation_error() - Non-critical error in Aggregation. Continuing with next step.
2024-09-12 00:01:00,603 - INFO - samplicity.scr.scr - f_calculate() - Completed Aggregation
2024-09-12 00:01:00,604 - WARNING - samplicity.scr.scr - f_calculate() - Calculation completed with 2 errors.
